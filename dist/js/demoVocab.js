function testSpeech(){var e=vocabController.getCurrentWord().name,r="#JSGF V1.0; grammar phrase; public <phrase> = "+e+";",t=new SpeechRecognition,o=new SpeechGrammarList;o.addFromString(r,1),t.grammars=o,t.lang=vocabData.lang,t.interimResults=!0,t.maxAlternatives=1,t.start(),t.onresult=function(e){var r=e.results[0][0].transcript;console.log(e.results[0][0].transcript),viewScore.renderInterimText(e.results[0][0].transcript),e.results[0].isFinal&&(vocabController.checkWord(r)?(viewMic.hideMic(),viewScore.renderCorrect()):viewScore.renderIncorrect())},t.onspeechend=function(){t.stop(),viewMic.restoreMic()},t.onerror=function(e){console.log("Error"+e.error),viewMic.restoreMic()}}var vocabData={currentWordIndex:0,score:0,lang:"zh-CN",list:[{name:"牛肉面",imgURL:"http://image82.360doc.com/DownloadImg/2015/02/1709/50263666_2.jpg",correct:!1,tries:0},{name:"炒饭",imgURL:"http://www.51dayaji.com/wp-content/uploads/2014/11/%E7%82%92%E9%A5%AD%E7%9A%84%E5%81%9A%E6%B3%953.jpg",correct:!1,tries:0},{name:"汉堡",imgURL:"http://science-all.com/images/wallpapers/hamburger/hamburger-6.PNG",correct:!1,tries:0},{name:"寿司",imgURL:"https://img.grouponcdn.com/deal/fmPws6o2uTweCftZu7yj/p4-2048x1229/v1/c700x420.jpg",correct:!1,tries:0},{name:"薯条",imgURL:"http://ali.xinshipu.cn/20140121/original/1390268120219.jpg",correct:!1,tries:0},{name:"冰淇淋",imgURL:"http://www.americasdairyland.com/assets/images/EWC/Ice-Cream-Hdr.jpg",correct:!1,tries:0}]},vocabController={getCurrentVocabImage:function(){return vocabData.list[vocabData.currentWordIndex].imgURL},getCurrentWord:function(){return vocabData.list[vocabData.currentWordIndex]},checkWord:function(e){return e==vocabController.getCurrentWord().name?(vocabData.list[vocabData.currentWordIndex].correct=!0,vocabData.score++,!0):(vocabData.list[vocabData.currentWordIndex].tries++,!1)},getNumberQuestions:function(){return vocabData.list.length},nextVocab:function(){vocabData.currentWordIndex>=vocabData.list.length-1?vocabData.currentWordIndex=0:vocabData.currentWordIndex++,viewVocab.render(),viewScore.renderOnNext()},previousVocab:function(){vocabData.currentWordIndex<=0?vocabData.currentWordIndex=vocabData.list.length-1:vocabData.currentWordIndex--,viewVocab.render(),viewScore.renderOnNext()},currentVocabCorrect:function(){return console.log("currentVocabCorrect "+vocabData.list[vocabData.currentWordIndex].correct),vocabData.list[vocabData.currentWordIndex].correct},getScore:function(){return vocabData.score},getTries:function(){return vocabData.list[vocabData.currentWordIndex].tries}},viewVocab={init:function(){this.imageWrapper=$(".imageWrapper"),this.leftArrow=$(".leftArrow"),this.rightArrow=$(".rightArrow"),this.rightArrow.click(function(){vocabController.nextVocab()}),this.leftArrow.click(function(){vocabController.previousVocab()})},render:function(){this.imageWrapper.html('<img src="'+vocabController.getCurrentVocabImage()+'">'),console.log(vocabData.list[vocabData.currentWordIndex].correct),vocabController.currentVocabCorrect()?viewMic.hideMic():viewMic.revealMic()}},viewScore={init:function(){this.numerator=$(".numerator"),this.denominator=$(".denominator"),this.denominator.html("/ "+vocabController.getNumberQuestions()),this.answerSlot=$(".answerSlot"),this.attempts=$(".attempts"),this.rightWrongSlot=$(".rightWrongSlot"),this.tries=$(".tries")},renderInterimText:function(e){this.answerSlot.html("<span>"+e+" </span>")},renderCorrect:function(){this.numerator.html(vocabController.getScore()),this.rightWrongSlot.html('<span class="glyphicon glyphicon glyphicon-ok" aria-hidden="true"></span>'),this.tries.html("Correctly Answered")},renderIncorrect:function(){this.rightWrongSlot.html('<span class="glyphicon glyphicon glyphicon-remove" aria-hidden="true"></span>'),this.tries.html("Tries: "+vocabController.getTries())},renderOnNext:function(){this.answerSlot.html(""),this.rightWrongSlot.html(""),vocabController.currentVocabCorrect()?(this.renderInterimText(vocabController.getCurrentWord().name),this.rightWrongSlot.html(""),this.tries.html("")):this.tries.html("Tries: "+vocabController.getTries())}},viewMic={init:function(){this.mic=$(".micWrap"),this.mic.click(function(){viewMic.activeMic(),testSpeech()})},activeMic:function(){this.mic.children("span").attr("style","color: red"),this.mic.attr("style","border: 7px solid red")},restoreMic:function(){this.mic.children("span").removeAttr("style"),this.mic.removeAttr("style")},hideMic:function(){this.mic.addClass("hidden")},revealMic:function(){this.mic.removeClass("hidden")}};try{var SpeechRecognition=SpeechRecognition||webkitSpeechRecognition,SpeechGrammarList=SpeechGrammarList||webkitSpeechGrammarList,SpeechRecognitionEvent=SpeechRecognitionEvent||webkitSpeechRecognitionEvent}catch(err){alert("Sorry, the browser does not support Web Speech. Please use Google Chrome for Speech Access.")}viewVocab.init(),viewScore.init(),viewMic.init();